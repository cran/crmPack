<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Ordinal CRM</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Ordinal CRM</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(crmPack)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; Warning: package &#39;ggplot2&#39; was built under R version 4.5.2</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; systemfonts and textshaping have been compiled with different versions of Freetype. Because of this, textshaping will not use the font cache provided by systemfonts</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; Registered S3 method overwritten by &#39;crmPack&#39;:</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt;   method       from  </span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt;   print.gtable gtable</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; Type crmPackHelp() to open help browser</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt; Type crmPackExample() to open example</span></span></code></pre></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The original CRM model introduced by <span class="citation">(O’Quigley, Pepe, and Fisher 1990)</span> dichotomises
toxicity events as either “Not toxic” or “DLT”. The ordinal CRM
generalises this model by classifying toxicities on an ordinal scale
with an arbitrary number of categories (though use of more than three or
four would be unusual).</p>
<p>This approach is particularly useful in non-oncology settings, where
there is a greater interest in adverse events that are not dose limiting
but are nonetheless undesirable.</p>
</div>
<div id="implementation" class="section level1">
<h1>Implementation</h1>
<div id="ordinal-data" class="section level2">
<h2>Ordinal data</h2>
<p><code>crmPack</code> uses the <code>DataOrdinal</code> class to
record data observed during an ordinal CRM trial. The
<code>OrdinalData</code> class differs from the <code>Data</code> class
only in that it contains an extra slot, <code>yCategories</code>, that
defines both the number of toxicity grades and their labels.For
example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>empty_ordinal_data <span class="ot">&lt;-</span> <span class="fu">DataOrdinal</span>(</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="at">doseGrid =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">10</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">10</span>)),</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">yCategories =</span> <span class="fu">c</span>(<span class="st">&quot;No tox&quot;</span> <span class="ot">=</span> <span class="dv">0</span><span class="dt">L</span>, <span class="st">&quot;Sub-tox AE&quot;</span> <span class="ot">=</span> <span class="dv">1</span><span class="dt">L</span>, <span class="st">&quot;DLT&quot;</span> <span class="ot">=</span> <span class="dv">2</span><span class="dt">L</span>),</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">placebo =</span> <span class="cn">FALSE</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>)</span></code></pre></div>
<p>defines a <code>DataOrdinal</code> object with three toxicity grades,
labelled “No tox`”, “Sub-tox AE” and “DLT”.</p>
<blockquote>
<p>Note that the <code>yCategories</code> slot must be an integer vector
with values ordered from <code>0</code> to
<code>length(yCategories) - 1</code>. Its labels must be unique. The
first entry, which must have value <code>0</code>, is always regarded as
the “no event” category. See [The LogisticLogNormalOrdinal class]
below.</p>
</blockquote>
<p>The <code>update</code>, <code>plot</code> and
<code>dose_grid_range</code> methods work exactly as they do for
<code>Data</code> objects:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">dose_grid_range</span>(empty_ordinal_data)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; [1]  10 100</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>ordinal_data <span class="ot">&lt;-</span> <span class="fu">update</span>(empty_ordinal_data, <span class="at">x =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">0</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>ordinal_data <span class="ot">&lt;-</span> <span class="fu">update</span>(ordinal_data, <span class="at">x =</span> <span class="dv">20</span>, <span class="at">y =</span> <span class="dv">0</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>ordinal_data <span class="ot">&lt;-</span> <span class="fu">update</span>(ordinal_data, <span class="at">x =</span> <span class="dv">30</span>, <span class="at">y =</span> <span class="dv">0</span>)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>ordinal_data <span class="ot">&lt;-</span> <span class="fu">update</span>(ordinal_data, <span class="at">x =</span> <span class="dv">40</span>, <span class="at">y =</span> <span class="dv">0</span>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>ordinal_data <span class="ot">&lt;-</span> <span class="fu">update</span>(ordinal_data, <span class="at">x =</span> <span class="dv">50</span>, <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>ordinal_data <span class="ot">&lt;-</span> <span class="fu">update</span>(ordinal_data, <span class="at">x =</span> <span class="dv">60</span>, <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="fu">plot</span>(ordinal_data)</span></code></pre></div>
<p><img role="img" aria-label="A graph showing Patient ID on the x axis and dose administered on the y axis.  The shape and colour of the symbols indicate the toxicity status of the patient: red triangles for DLTs, orange circles for sub-toxic AEs and black triangles for no reported toxicities.  Patients 1 to 4 are dosed at 10, 20, 30 and 40, with no toxicitis reported.  patients 5 to 7 are dosed at 50, with patient 6 reporting a sub-toxic AE.  Patients 8 to 10 are treated at 60.  Patient 9 reports a sub-toxic AE and patient 10 a DLT." src="data:image/png;base64,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" alt="A graph showing Patient ID on the x axis and dose administered on the y axis.  The shape and colour of the symbols indicate the toxicity status of the patient: red triangles for DLTs, orange circles for sub-toxic AEs and black triangles for no reported toxicities.  Patients 1 to 4 are dosed at 10, 20, 30 and 40, with no toxicitis reported.  patients 5 to 7 are dosed at 50, with patient 6 reporting a sub-toxic AE.  Patients 8 to 10 are treated at 60.  Patient 9 reports a sub-toxic AE and patient 10 a DLT." /></p>
</div>
<div id="the-logisticlognormalordinal-class" class="section level2">
<h2>The <code>LogisticLogNormalOrdinal</code> class</h2>
<p><code>crmPack</code> fits a constrained logistic log normal model to
ordinal data. The logit of the probability of toxicity at each grade for
a given dose is modelled in the log odds space as a linear regression
with common slope and a different intercept for each toxicity grade.</p>
<blockquote>
<p>Note, unlike other model classes,
<code>LogisticLogNormalOrdinal</code> requires a diagonal covariance
matrix. This is because the constraints on the $alpha;s - the intercept
parameters - imposes a correlation on the model’s parameters. Thus, any
covariance structure requested by the end user could not be honoured by
the model.</p>
</blockquote>
<p>Let p<sub>k</sub>(d) be the probability that the response of a
patient treated at dose d is in category k <em><em>or higher</em></em>,
k=0, …, K; d=1, …, D.</p>
<p>Then</p>
<p><span class="math display">\[ \log \left( \frac{p}{1-p}\right) =
\alpha_k + \beta \cdot \log \left( \frac{d}{d_{ref}} \right)  \]</span>
for k=1, …, K [p<sub>0</sub>(d) = 1 by definition] where d<sub>ref</sub>
is a reference dose.</p>
<p>The αs are constrained such that α<sub>1</sub> &gt; α<sub>2</sub>
&gt; … &gt; α<sub>K</sub>.</p>
<p>The priors for the model’s parameters are:</p>
<p><span class="math display">\[ \alpha_k \sim N(\mu_{\alpha_k},
\sigma_{\alpha_k}^2) \]</span></p>
<p>and</p>
<p><span class="math display">\[ \log(\beta) \sim N(\mu_\beta,
\sigma_\beta^2) \]</span></p>
<p>A <code>LogisticLogOrdinal</code> is initialised in exactly the same
way as a <code>LogisticLogNormal</code> object:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>ordinal_model <span class="ot">&lt;-</span> <span class="fu">LogisticLogNormalOrdinal</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">0</span>),</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">cov =</span> <span class="fu">diag</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>)),</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">ref_dose =</span> <span class="dv">55</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>)</span></code></pre></div>
<p>The entries in the <code>mean</code> and <code>cov</code> parameters
define the hyper priors for α<sub>1</sub> to α<sub>K-1</sub> and β in
that order.</p>
</div>
<div id="model-fitting" class="section level2">
<h2>Model fitting</h2>
<p><code>mcmc</code> works as expected with ordinal models:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>opts <span class="ot">&lt;-</span> <span class="fu">.DefaultMcmcOptions</span>()</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">mcmc</span>(ordinal_data, ordinal_model, opts)</span></code></pre></div>
<blockquote>
<p>The warning message is expected and can be ignored. It will be
suppressed in a future version of <code>crmPack</code>. See issue
748.</p>
</blockquote>
<p>The <code>Samples</code> object returned by <code>mcmc</code> is a
standard <code>Samples object</code>. The names of the entries in its
<code>data</code> slot are</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">names</span>(samples<span class="sc">@</span>data)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;alpha1&quot; &quot;alpha2&quot; &quot;beta&quot;</span></span></code></pre></div>
<p>It can be passed to the <code>fit</code> method, using the
<code>grade</code> parameter to specify the toxicity grade for which
cumulative probabilities of toxicity are required:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">fit</span>(samples, ordinal_model, ordinal_data, <span class="at">grade =</span> <span class="dv">1</span><span class="dt">L</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt;    dose     middle        lower     upper</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; 1    10 0.04106843 2.780051e-10 0.2649321</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; 2    20 0.07903967 1.818724e-06 0.3426187</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; 3    30 0.13321409 2.921371e-04 0.4246276</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; 4    40 0.21651544 9.145959e-03 0.5016036</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; 5    50 0.34589093 1.120942e-01 0.6331624</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; 6    60 0.49739502 2.001135e-01 0.8503398</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; 7    70 0.60535082 2.295615e-01 0.9634213</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; 8    80 0.67300273 2.491971e-01 0.9925207</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; 9    90 0.71829852 2.655986e-01 0.9981956</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; 10  100 0.75076824 2.842318e-01 0.9994676</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="fu">fit</span>(samples, ordinal_model, ordinal_data, <span class="at">grade =</span> <span class="dv">2</span><span class="dt">L</span>)</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt;    dose     middle        lower     upper</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; 1    10 0.02272999 1.362883e-10 0.1726505</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; 2    20 0.04399276 8.468818e-07 0.2241257</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; 3    30 0.07491536 1.613767e-04 0.2777876</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt; 4    40 0.12404060 5.872908e-03 0.3312090</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt; 5    50 0.20875366 5.486299e-02 0.4381415</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt; 6    60 0.33895289 9.642491e-02 0.7136278</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt; 7    70 0.45744064 1.153424e-01 0.9299138</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt; 8    80 0.54043567 1.282689e-01 0.9858731</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt; 9    90 0.59904409 1.397357e-01 0.9968905</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co">#&gt; 10  100 0.64230277 1.507670e-01 0.9991170</span></span></code></pre></div>
<p>The <code>cumulative</code> flag can be used to request
grade-specific probabilities.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">fit</span>(samples, ordinal_model, ordinal_data, <span class="at">grade =</span> <span class="dv">1</span><span class="dt">L</span>, <span class="at">cumulative =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt;    dose     middle        lower     upper</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; 1    10 0.01833844 7.251679e-11 0.1391336</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; 2    20 0.03504690 4.235974e-07 0.1999673</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; 3    30 0.05829872 7.056551e-05 0.2749734</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; 4    40 0.09247484 1.261845e-03 0.3390429</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; 5    50 0.13713728 4.426444e-03 0.4161814</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; 6    60 0.15844214 5.263678e-03 0.4625697</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; 7    70 0.14791018 4.247342e-03 0.4648826</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; 8    80 0.13256706 1.873256e-03 0.4585479</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; 9    90 0.11925443 7.371508e-04 0.4422843</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; 10  100 0.10846547 1.994806e-04 0.4111742</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="fu">fit</span>(samples, ordinal_model, ordinal_data, <span class="at">grade =</span> <span class="dv">2</span><span class="dt">L</span>, <span class="at">cumulative =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt;    dose     middle        lower     upper</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; 1    10 0.02272999 1.362883e-10 0.1726505</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt; 2    20 0.04399276 8.468818e-07 0.2241257</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; 3    30 0.07491536 1.613767e-04 0.2777876</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt; 4    40 0.12404060 5.872908e-03 0.3312090</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; 5    50 0.20875366 5.486299e-02 0.4381415</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; 6    60 0.33895289 9.642491e-02 0.7136278</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt; 7    70 0.45744064 1.153424e-01 0.9299138</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt; 8    80 0.54043567 1.282689e-01 0.9858731</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt; 9    90 0.59904409 1.397357e-01 0.9968905</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt; 10  100 0.64230277 1.507670e-01 0.9991170</span></span></code></pre></div>
<blockquote>
<p>Note that, for <code>grade == K - 1</code>, the cumulative and
grade-specific probabilities of toxicities are identical.</p>
</blockquote>
<p>The <code>plot</code> method also takes <code>grade</code> and
<code>cumulative</code> parameters.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">plot</span>(samples, ordinal_model, ordinal_data, <span class="at">grade =</span> <span class="dv">2</span><span class="dt">L</span>)</span></code></pre></div>
<p><img role="img" aria-label="A graph of the posterior probability of toxicity (DLT only) against dose.  The mean probability of toxicity is barely above 0% at a dose of zero and rises in a sigmoidal curve to around 65% at a dose of 100.  The confidence interval is relatively narrow for low doses but widens considerably for doses over 60, extending from around 15% to 100% for a dose of 100." src="data:image/png;base64,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" alt="A graph of the posterior probability of toxicity (DLT only) against dose.  The mean probability of toxicity is barely above 0% at a dose of zero and rises in a sigmoidal curve to around 65% at a dose of 100.  The confidence interval is relatively narrow for low doses but widens considerably for doses over 60, extending from around 15% to 100% for a dose of 100." /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">plot</span>(samples, ordinal_model, ordinal_data, <span class="at">grade =</span> <span class="dv">1</span><span class="dt">L</span>)</span></code></pre></div>
<p><img role="img" aria-label="A graph of the posterior cumulative probability of toxicity (sub-toxic AE or DLT) against dose.  The mean probability of toxicity is barely above 0% at a dose of zero and rises in a sigmoidal curve to around 75% at a dose of 100.  The confidence interval is relatively narrow for low doses but widens considerably for doses over 60, extending from around 30% to 100% for a dose of 100." src="data:image/png;base64,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" alt="A graph of the posterior cumulative probability of toxicity (sub-toxic AE or DLT) against dose.  The mean probability of toxicity is barely above 0% at a dose of zero and rises in a sigmoidal curve to around 75% at a dose of 100.  The confidence interval is relatively narrow for low doses but widens considerably for doses over 60, extending from around 30% to 100% for a dose of 100." /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">plot</span>(samples, ordinal_model, ordinal_data, <span class="at">grade =</span> <span class="dv">1</span><span class="dt">L</span>, <span class="at">cumulative =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img role="img" aria-label="A graph of the posterior probability of sub toxic AE against dose.  The mean probability of toxicity is barely above 0% at a dose of zero, rises to a peak of about 18% at a dose of 60 before falling to around 12% at a dose of 100.  The confidence interval is relatively narrow for low doses but widens considerably for doses over 60, extending from around 30% to 100% for a dose of 100." src="data:image/png;base64,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" alt="A graph of the posterior probability of sub toxic AE against dose.  The mean probability of toxicity is barely above 0% at a dose of zero, rises to a peak of about 18% at a dose of 60 before falling to around 12% at a dose of 100.  The confidence interval is relatively narrow for low doses but widens considerably for doses over 60, extending from around 30% to 100% for a dose of 100." /></p>
</div>
<div id="rules-classes-for-ordinal-models" class="section level2">
<h2><code>Rules</code> classes for ordinal models</h2>
<p>For each class of <code>Rule</code> (that is,
<code>CohortSize</code>, <code>Increments</code>, <code>NextBest</code>
and <code>Stopping</code>), <code>crmPack</code> provides a single
wrapper class that allows the <code>Rule</code> to be applied in trials
using ordinal CRM models. The wrapper class has the name
<code>&lt;Rule&gt;Ordinal</code> and takes two parameters,
<code>rule</code> and <code>grade</code>. <code>rule</code> defines the
standard <code>crmPck</code> <code>Rule</code> and <code>grade</code>
the toxicity grade at which the rule should be applied.</p>
<p>For example</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>dlt_rule <span class="ot">&lt;-</span> <span class="fu">CohortSizeDLT</span>(<span class="at">intervals =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">cohort_size =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>))</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>ordinal_rule_1 <span class="ot">&lt;-</span> <span class="fu">CohortSizeOrdinal</span>(<span class="at">grade =</span> <span class="dv">1</span><span class="dt">L</span>, <span class="at">rule =</span> dlt_rule)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>ordinal_rule_2 <span class="ot">&lt;-</span> <span class="fu">CohortSizeOrdinal</span>(<span class="at">grade =</span> <span class="dv">2</span><span class="dt">L</span>, <span class="at">rule =</span> dlt_rule)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="fu">size</span>(ordinal_rule_1, <span class="dv">50</span>, empty_ordinal_data)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="fu">size</span>(ordinal_rule_2, <span class="dv">50</span>, empty_ordinal_data)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="fu">size</span>(ordinal_rule_1, <span class="dv">50</span>, ordinal_data)</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="fu">size</span>(ordinal_rule_2, <span class="dv">50</span>, ordinal_data)</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; [1] 3</span></span></code></pre></div>
<p><code>Rules</code> based on different toxicity grades can be combined
to produce complex rules. Here we define two <code>Increments</code>
rules, one based on toxicity grade 1, the other on toxicity grade 2.
Recall two sub toxic AEs and one DLT have been reported in the example
data set.</p>
<p>Thus, the rule based on sub-toxic AEs allows a maximum increment of
0.67 because three events have been reported, giving a maximum permitted
dose of 100.2. As only one DLT has been reported, the second rule allows
an increment of 0.5, giving a maximum permitted dose of 90.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>ordinal_rule_1 <span class="ot">&lt;-</span> <span class="fu">IncrementsOrdinal</span>(</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="at">grade =</span> <span class="dv">1</span><span class="dt">L</span>,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="at">rule =</span> <span class="fu">IncrementsRelativeDLT</span>(<span class="at">intervals =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">increments =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">1.5</span>, <span class="fl">0.67</span>))</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="fu">maxDose</span>(ordinal_rule_1, ordinal_data)</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt; [1] 100.2</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>ordinal_rule_2 <span class="ot">&lt;-</span> <span class="fu">IncrementsOrdinal</span>(</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  <span class="at">grade =</span> <span class="dv">2</span><span class="dt">L</span>,</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>  <span class="at">rule =</span> <span class="fu">IncrementsRelativeDLT</span>(<span class="at">intervals =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">increments =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">0.5</span>))</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="fu">maxDose</span>(ordinal_rule_2, ordinal_data)</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt; [1] 90</span></span></code></pre></div>
<p>The two grade-specific rules can be combined into a single rule using
<code>IncrementsMin</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>trial_rule <span class="ot">&lt;-</span> <span class="fu">IncrementsMin</span>(<span class="fu">list</span>(ordinal_rule_1, ordinal_rule_2))</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">maxDose</span>(trial_rule, ordinal_data)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt; [1] 90</span></span></code></pre></div>
</div>
</div>
<div id="on-the-need-for-a-diagonal-covariance-matrix" class="section level1">
<h1>On the need for a diagonal covariance matrix</h1>
<p>Consider a standard logistic log Normal CRM model:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">LogisticLogNormal</span>(</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="at">mean =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="at">cov =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">3</span>), <span class="at">ncol =</span> <span class="dv">2</span>),</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="at">ref_dose =</span> <span class="dv">45</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>model<span class="sc">@</span>params<span class="sc">@</span>cov</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; [1,]  4.0 -0.5</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; [2,] -0.5  3.0</span></span></code></pre></div>
<p>We can estimate the prior using an empty <code>Data</code>
object…</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">Data</span>(<span class="at">doseGrid =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">10</span>))</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>options <span class="ot">&lt;-</span> <span class="fu">McmcOptions</span>(</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="at">samples =</span> <span class="dv">30000</span>,</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  <span class="at">rng_kind =</span> <span class="st">&quot;Mersenne-Twister&quot;</span>,</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  <span class="at">rng_seed =</span> <span class="dv">8191316</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">mcmc</span>(data, model, options)</span></code></pre></div>
<p>and then obtain the correlation between the model’s parameters
[recalling that the prior is defined in terms of log(alpha1)]…</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">cbind</span>(samples<span class="sc">@</span>data<span class="sc">$</span>alpha0, <span class="fu">log</span>(samples<span class="sc">@</span>data<span class="sc">$</span>alpha1)))</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>sigmaHat <span class="ot">&lt;-</span> <span class="fu">cov</span>(d)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>sigmaHat</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt;            [,1]       [,2]</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt; [1,]  4.0094331 -0.5416752</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt; [2,] -0.5416752  3.0363958</span></span></code></pre></div>
<p>So we requested a covariance of -0.5 and got -0.5416755.2. Pretty
good!</p>
<p>Now look an ordinal CRM model with non-zero correlation between its
parameters.</p>
<p>To begin, take a copy of the current
<code>LogisticLogNormalOrdinal</code> model and give it a non-diagonal
covariance matrix by accessing its <code>params@cov</code> slot
directly, deliberately avoiding object validation.</p>
<blockquote>
<p>NB This is poor practice and not recommended. It is done here purely
for illustration.</p>
</blockquote>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>ordinal_model_temp <span class="ot">&lt;-</span> ordinal_model</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>ordinal_model_temp<span class="sc">@</span>params<span class="sc">@</span>cov <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>ordinal_model_temp<span class="sc">@</span>params<span class="sc">@</span>cov</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; [1,]  4.0 -0.5 -0.5</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt; [2,] -0.5  3.0 -0.5</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; [3,] -0.5 -0.5  1.0</span></span></code></pre></div>
<p>Fit the revised model to obtain the prior.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>ordinal_data <span class="ot">&lt;-</span> <span class="fu">DataOrdinal</span>(<span class="at">doseGrid =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">10</span>))</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>ordinal_samples <span class="ot">&lt;-</span> <span class="fu">mcmc</span>(ordinal_data, ordinal_model_temp, options)</span></code></pre></div>
<p>Finally, look at the covariance matrix, remembering to use
<code>log(beta)</code> rather than <code>beta</code>…</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>ordinalD <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="fu">cbind</span>(</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>    ordinal_samples<span class="sc">@</span>data<span class="sc">$</span>alpha1,</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>    ordinal_samples<span class="sc">@</span>data<span class="sc">$</span>alpha2,</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>    <span class="fu">log</span>(ordinal_samples<span class="sc">@</span>data<span class="sc">$</span>beta)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  )</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>sigmaHat <span class="ot">&lt;-</span> <span class="fu">cov</span>(ordinalD)</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>sigmaHat</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="co">#&gt;             [,1]        [,2]         [,3]</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="co">#&gt; [1,]  4.00158899 2.768345336 -0.001112980</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co">#&gt; [2,]  2.76834534 2.924696828  0.008697924</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="co">#&gt; [3,] -0.00111298 0.008697924  1.012033823</span></span></code></pre></div>
<p>The correlations are nothing like what we requested. This is due to
the constraints imposed on the intercepts by the model. The situation
will most likely worsen as the number of toxicity categories
increases.</p>
<p>We have an open issue - #755 -to examine options for allowing end
users to specify correlation structures for ordinal CRM models. If you
would like to contribute, please do so.</p>
</div>
<div id="some-observations" class="section level1">
<h1>Some observations</h1>
<ul>
<li>We are currently considering the need for making grade-specific
functionality available across more <code>crmPack</code> methods. If you
have a specific use case that is not currently supported, please contact
us.</li>
<li>If you have a need for ordinal CRM in dual endpoint models, please
let us know.</li>
<li>Had <code>crmPack</code> supported ordinal CRM from the outset, the
classes that support standard, binary, CRM models would have been
sub-classes of the more general ordinal implementations. We did consider
taking this approach when adding support for ordinal CRM models to the
existing code. We decided against doing so for purely defensive and
conservative reasons. Had we introduced the ordinal classes as parents
of the existing classes, changes to the code base would have been much
more substantial and we were concerned that we might miss some implicit
assumptions about the dimensionality of the existing models. We
therefore chose to implement ordinal classes as siblings, rather than
parents, of the existing classes. This approach minimises the risk of
breaking existing end-user code at the risk of slightly greater
complexity in using the new classes.</li>
</ul>
</div>
<div id="environment" class="section level1">
<h1>Environment</h1>
<pre><code>#&gt; R version 4.5.1 (2025-06-13 ucrt)
#&gt; Platform: x86_64-w64-mingw32/x64
#&gt; Running under: Windows 11 x64 (build 26200)
#&gt; 
#&gt; Matrix products: default
#&gt;   LAPACK version 3.12.1
#&gt; 
#&gt; locale:
#&gt; [1] LC_COLLATE=C                        LC_CTYPE=German_Switzerland.utf8   
#&gt; [3] LC_MONETARY=German_Switzerland.utf8 LC_NUMERIC=C                       
#&gt; [5] LC_TIME=German_Switzerland.utf8    
#&gt; 
#&gt; time zone: Asia/Taipei
#&gt; tzcode source: internal
#&gt; 
#&gt; attached base packages:
#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     
#&gt; 
#&gt; other attached packages:
#&gt; [1] crmPack_2.0.1 ggplot2_4.0.1
#&gt; 
#&gt; loaded via a namespace (and not attached):
#&gt;  [1] sass_0.4.10          generics_0.1.4       xml2_1.3.8          
#&gt;  [4] futile.options_1.0.1 lattice_0.22-7       stringi_1.8.7       
#&gt;  [7] digest_0.6.37        magrittr_2.0.4       evaluate_1.0.5      
#&gt; [10] grid_4.5.1           RColorBrewer_1.1-3   bookdown_0.44       
#&gt; [13] mvtnorm_1.3-3        fastmap_1.2.0        jsonlite_2.0.0      
#&gt; [16] processx_3.8.6       backports_1.5.0      ps_1.9.1            
#&gt; [19] formatR_1.14         gridExtra_2.3        viridisLite_0.4.2   
#&gt; [22] scales_1.4.0         textshaping_1.0.4    jquerylib_0.1.4     
#&gt; [25] Rdpack_2.6.4         cli_3.6.5            rlang_1.1.6         
#&gt; [28] rbibutils_2.4        futile.logger_1.4.3  parallelly_1.45.1   
#&gt; [31] withr_3.0.2          cachem_1.1.0         yaml_2.3.10         
#&gt; [34] parallel_4.5.1       tools_4.5.1          coda_0.19-4.1       
#&gt; [37] checkmate_2.3.3      dplyr_1.1.4          lambda.r_1.2.4      
#&gt; [40] kableExtra_1.4.0     vctrs_0.6.5          R6_2.6.1            
#&gt; [43] lifecycle_1.0.4      stringr_1.6.0        GenSA_1.1.14.1      
#&gt; [46] rjags_4-17           pkgconfig_2.0.3      pillar_1.11.1       
#&gt; [49] bslib_0.9.0          later_1.4.2          gtable_0.3.6        
#&gt; [52] glue_1.8.0           Rcpp_1.1.0           systemfonts_1.3.1   
#&gt; [55] xfun_0.52            tibble_3.3.0         tidyselect_1.2.1    
#&gt; [58] rstudioapi_0.17.1    knitr_1.50           farver_2.1.2        
#&gt; [61] htmltools_0.5.8.1    quarto_1.5.1         labeling_0.4.3      
#&gt; [64] rmarkdown_2.30       svglite_2.2.1        compiler_4.5.1      
#&gt; [67] S7_0.2.0</code></pre>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-oquigley1990" class="csl-entry">
O’Quigley, John, Margaret Pepe, and Lloyd Fisher. 1990. <span>“Continual
Reassessment Method: A Practical Design for Phase 1 Clinical Trials in
Cancer.”</span> <em>Biometrics</em> 46 (1): 33–48.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
